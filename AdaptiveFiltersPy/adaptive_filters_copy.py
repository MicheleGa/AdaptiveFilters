"""
Adaptive Filters Example
========================

In this example, we will run adaptive filters for system identification.
"""
from __future__ import division, print_function
from re import L
import time

import numpy as np 
from scipy.signal import fftconvolve
import math
import matplotlib.pyplot as plt
import pyroomacoustics as pra

# parameters
length = 16  # the unknown filter length
n_samples = 512  # the number of samples to run
SNR = 15  # signal to noise ratio

# the unknown filter (unit norm)
w = [-0.3124508151231277, 0.7898902376294418, -1.6508464083525936, 1.8703077198146183, 1.71649637430362, -0.4516394452794979, -0.9832198023294824, 2.331199503761985, -0.3712536821686994, 0.4253330637822722, -1.1723665873324225, 0.5206766211372666, -0.6328290201725669, 0.7422510536462943, -0.5289934652362392, 0.5283466143828165]

w /= np.linalg.norm(w)

# create a known driving signal
x = [-0.911192160066649, 0.8208711214785475, -0.18297447056407135, 0.7697908799808512, 1.912540561593053, -0.4242868816859914, -0.1390639673776624, 0.5700067168275641, -2.4090091020227016, -0.23898674198762596, 0.06858779450431406, -0.7866304351556063, 0.5451060082326273, 0.41871902409105805, 1.3933695419742345, -0.36374132421603267, 1.5209605220264029, -0.3608799401155682, -0.04398807341759551, -0.9528449564975399, -1.3003894341969255, 0.22474395408888181, -1.4456321557283662, 0.030573602703624546, -0.9251360423723475, -1.3939136238098928, -0.42870188170697987, -0.6768289308330545, -0.0538277546072774, 0.10970994423109687, 0.7374274000362603, -0.14606431771695008, 1.3608137841906114, -1.5882259274112058, -0.5262082153424222, 0.8552032644266762, 0.15238921806341468, 1.6370776798829363, 0.363069433301334, 1.3864716746148662, -1.1277878193812827, 1.742400415540367, 0.2477745122655458, -0.35391008396171475, 0.6421822845040088, 1.0746420520106919, 1.0940055193765699, 0.410891512729446, 1.088067262651292, -0.7212318325150737, -0.4431047728336127, 1.2290167702667627, -0.44595082278363274, 0.5158895593472015, -0.565062010568021, 1.0917986421461356, -0.8146262968765925, -1.672572879196963, -0.050542513868270245, 1.040677043267854, -0.986939640567338, -0.17925913409091868, 0.060838621744442684, -0.6424465018488846, -1.043764602348557, -1.0552089796278794, 0.8287750746862013, 0.23961526968632432, -0.8936638853368236, -1.019005817001285, -0.18397909905597193, 1.0410896659768143, -0.920871704125777, -1.7211599293514759, -0.5626308219542534, 1.9525939059865254, 0.8793093415890372, 1.62407198266286, 0.38185215196458977, 1.6508351634436045, 0.07250363774266987, 1.615123704755927, 0.4068805314699507, 2.192109792406655, 2.491109866539585, 0.4355296087477012, -1.0572766826606401, 0.5111695387655838, 1.7843117180579195, 0.4901903370946781, -0.5074558845429472, -0.3159504819269705, 0.21341001966874756, 0.2693610875528144, 0.04302455793474961, 0.7906752335875669, 1.504981531719321, 1.7583722795578116, -1.4243434007582798, 0.7580966277858666, 0.24766310927074078, 0.5263659367353709, -0.518569762297619, 2.029380693764936, -2.0005105745196383, 0.7951711275615518, 0.3988359002301673, 0.5841978033971456, -1.1409241037294198, 0.5121839030912108, -0.37152817235269536, 0.13853901640243033, 0.49121755121715965, -0.04063097878608479, 2.222544864930833, -0.25320592110546514, 1.9454772886767426, 0.13348028449862942, 0.8269495952394603, 0.16415736529439723, -1.2565366410756105, -0.6624789880259069, 0.5885275185125254, -0.8318156843263863, -0.7760573786698245, 0.14158728478149465, -1.2386409818560138, 0.5084788766833417, -1.309583773946907, -0.6782479825322775, -0.8349839182661358, 0.7652285123106365, 0.5581991755117766, -0.6604998411319513, -0.6430105617071602, -1.120920427132822, -0.4216249792078905, -0.06806749133804466, 1.544553096013565, -0.7530842321055514, -2.6004953504454047, -1.0739221218279151, -0.1457231689961836, 0.5378566062128319, 0.6495643527122095, -0.41946246793168385, -1.4102340553563426, 0.7955984025255771, 1.2371391378940761, -1.3545890396439186, 0.15944677133773597, -0.453371256583694, -0.24641975432339097, 2.0927583288573404, 0.046483492838369354, -0.9667364092966897, -0.802394627609385, 0.08991224573381862, 0.6499084848891602, -0.03743805109371671, -0.30180379173015864, 0.174237233393707, -1.7012129211257003, -0.35049345788529546, -0.9934147404713751, 0.5665658375399351, -0.8505402570641262, 0.5520650375600624, 1.1536254429727413, 0.8618396499032531, -0.36213225239093555, -1.6628234532515553, 1.3831243804025308, -2.442566768001817, 0.25673002268741446, 0.6372775219011086, 0.48175127470195434, -0.10716735827727304, -0.93798945177815, 1.23472704663316, 1.2360912399475377, 1.7971487666528387, 0.530650061010605, -0.2068937931484932, -0.694792019795889, -1.2764282057342942, -0.06792013580572503, -0.021203565533639567, -0.7255790927451528, 0.02534212808471181, -0.1443316334306954, 0.31999351902985035, -0.3794497632944315, 0.2833992481946513, 1.676384182098891, -0.9154429362355997, -0.6658388444385082, 0.9340306027853863, -1.1925931250028652, -0.09974645871042527, 0.8840822342338471, 1.9193726584077737, 2.4788750017646137, -1.0533704521171658, 0.7651411563671257, 1.4242212752247123, -0.500476770204645, -1.0139961409412048, -0.9561556804788718, -0.4154781789158916, -1.3347719421522894, -0.8217430201225342, -0.26657005227024, 0.8708151311780106, 0.2873578264089365, 1.6301838672988336, 0.07275650406920277, 0.9441420703812602, 0.0913837693696371, 0.20207917032899703, 1.1911027318694405, 2.056782065055065, -1.3271419063352163, 0.14820999152488196, 1.075388462543067, -0.3980467792550819, 0.45249297533564736, -0.650243118273861, -1.9768621749715898, -0.8558517953193915, 0.14944784901504424, 0.16975533888838032, 1.4256154132639631, -0.4130031426046947, -1.3866731242573975, 1.4238330746676264, 0.4610093785295759, -0.38774237821331003, -0.9690144004287518, 0.6124692182287256, -1.3119728083133066, -0.5567567160483001, -0.16212721329711666, -0.42716401870894527, 0.21092964332047115, -0.4083976365290874, 0.35515900868034056, 0.3834684043466456, 0.7942236415304941, 0.9090225505340124, -0.9612293615672042, -0.021559009657674877, -1.394635039744034, -1.6925022375477206, 0.47205276490753734, -0.37640400104885646, 0.11938184302468567, 1.2763517727240152, -1.8641944678907718, 0.7048834528939734, -0.4913863761688434, -0.8993015209668365, 1.020732337712986, 0.4850558225640615, -1.1822814322152215, 1.8341323914777132, -0.6933456240202794, -0.7210729048012295, 0.06756974297876207, -0.1157076356590613, -0.15168437750266542, 0.4591786817152065, 0.30579382556253776, 0.22685245649523333, -2.1762083219239785, 0.969154367046015, 0.26287504353394825, 0.9074876367745739, 0.2951593983158426, -1.0964090396114337, -0.9767839196956413, -0.311972955582664, -1.101102072725409, -0.9895218140648097, 0.5660714041408811, -1.3525736988952564, -0.8623622720957964, -0.42487919060167106, 0.5856794697356826, -1.3385477575060871, 0.870079167701243, 1.300791129224833, 0.9927721251808318, -1.1503935514613426, 0.7338304588364017, -0.38441705526793646, -0.019956534637656297, -0.17862790990151026, 0.07245315046285769, 0.004275839614250053, -0.003484012191550833, -1.310966961237949, -1.7789971672099931, -0.42012543590631335, -2.990146814173651, 0.6567461960925114, -1.6687136558757971, -0.6897388443546483, 0.5262638633854674, 0.8401053799639013, 1.203800510335584, -0.5855342382194056, -1.220537719796502, 0.3494029475495385, 1.10828295770041, -0.902073795528335, 0.2604350518181465, -1.8262947640924192, 1.0940217395952387, 0.4708678139013601, 0.6179997912440831, 0.156132500951615, 0.021850845142446482, 0.33996732507292177, -0.6846792456156131, 0.3660328497189357, -0.2421557094407518, 0.11837279324657318, 0.4815977702739792, 1.4105782190344498, 1.7021776771332178, -0.7741390773456358, -0.10855784053996945, -0.12222081523352595, 0.4560126845808676, 0.8396427943506378, 0.5445804864594475, 2.082012479231225, 1.0084625091581048, 0.9276042779515745, 1.3873399700804265, 0.8929701634718941, 0.3753325551881799, 0.058339630031619724, 1.1437682754831118, 0.24272976112585612, -0.9133243264366305, 2.168574962772272, -1.8310812356778914, 0.9403374419053173, -0.21009563231176356, 1.0984441679142598, -2.109163854694222, 0.16392541381978407, -0.6161297133638663, -1.7608210897542675, 1.1736187337671673, 0.18793724977778933, 1.3958999837848733, 0.009828896153757231, -1.507737665346135, -0.9898390919755607, 1.9396749344185542, 2.7291968332787007, -0.8475773583958827, -2.1339770723266684, 0.4474884780319972, 0.9171155003757997, 0.16533545680647627, -0.26879302013649237, -1.3962239632472002, 0.6294256947169694, -1.7069256284121364, 1.672694477890519, 1.1017778713904554, 0.5808305130904002, -1.0921681546612785, -0.5487717451300774, -3.0632218919978897, 2.3616281721824905, -1.4599533000681009, 0.9664009624644975, 1.0088836707832434, -0.8032460861058016, 1.061038542445243, 0.24684606958849464, 0.4409680112560184, -0.7384267020296115, 1.423245403746556, 2.1287835647794684, -0.1729928415470418, -0.7988672781283922, -0.7549488525885236, 1.2875258492477002, 0.4783594289422044, -0.23501824163680166, -0.955142692275714, 0.5387657165461819, -1.5690056970184776, -0.3023819490567954, 0.13564280948404597, 0.879864235441213, -0.18983024979103152, 0.5478805778615983, 1.2134622723701367, 0.30676744751866536, 0.4934326784609868, -1.0299791296129621, -0.6243298539435241, 0.40962615613918735, -0.18458010489733065, 1.0906332620652333, 1.9033444986512575, 0.0003731810367685989, 0.6039175800872516, -1.0763403474166435, 0.4610280511083727, 1.375285874688, -0.8198129764353215, -1.3048704841668897, 0.22205100280166457, -1.7392119959728456, -0.02175515823409539, 0.579341414997052, -1.5578074831805988, -1.2910461175890193, -0.5096820947094809, 0.623460278321303, 0.5643805125446976, 0.8237675145067469, 1.1841419180187625, -1.1566741578481083, 0.9052099815990474, 0.5508488784208802, 0.7753340181468387, 0.7205801782904314, 1.4294852242727938, -0.4904485765837081, -0.2584153574145979, 1.4822462698855077, -0.31484791746960633, -0.35033326443136104, 0.8908153883322099, 1.3415881808542072, -1.1159212879838192, -0.10409536286286945, 0.6796058326367553, 0.7307788236212779, -1.4647945621819163, -1.6625322431678031, 0.07247078919988469, -1.4566544299268935, 0.06812737990971109, -0.9941431794832781, -0.41782419793774545, -0.2514698556193328, 1.409747472165652, 0.9648145454533567, -0.3290506003757414, 1.2478230991635695, -1.5389388835288187, 0.34896371729390874, -1.5964501404225022, 0.8717965121326063, -0.12082181125315299, -1.3557583005301612, -1.5773429235569576, 0.32431044707918566, -0.229130118108778, -1.7378171449241469, -0.09928036393908443, -1.0171991240163214, 0.9122345929115491, 0.15891059574029778, -1.61345820999334, -0.5577050161152356, 0.07910936203666746, -0.19650375176867088, -0.7125836912820571, -1.0451329869972226, -0.05369241715415257, -0.07427136754427287, -0.67801771919605, -1.6049998976901982, -0.7825368867625668, -2.0493548923634823, -0.465866930837627, 1.4137273577093077, -0.6602859625624754, 1.116220832281794, -1.0681970478097704, 0.3864143153528642, -0.17127136334295842, 0.03949670454085812, 1.46992489221647, -0.846985907861283, 0.7721868298017396, 0.10010047024230946, 1.0629588375204262, -1.6847364783492444, 0.04250415050927595, 0.48311243040300844, 0.23879746111900044, 0.5126279172975534, 0.5339250921019433, -0.6663586522364054, -1.0297570685645112, 0.7455327697426981, -0.9389893849782798, -1.2223520359095388, 1.7869739846803132, -1.4522914267976315]

# convolve with the unknown filter
#d_clean = fftconvolve(x, w)[:n_samples]

# add some noise to the reference signal
#d = d_clean + np.random.randn(n_samples) * 10 ** (-SNR / 20.0)

d = [0.2562586555962992, -0.40553692583692125, 0.36632719487475973, -0.8973742768883135, -0.08948675132044862, 0.11669320828216534, -0.5413498219065526, 0.49110017085937885, 1.2405978693097628, -1.558072738343289, 1.3514997420081394, 0.17057697981554196, -1.4116031336767572, -0.21956085620610546, 0.12847762952935893, -1.2938274358337383, -0.1833170517403226, 1.171339665531406, -0.2311809988561044, 0.8835757010345451, 0.6578175891023164, 0.49742331024326986, -0.22602612160538244, -0.4391403567215888, -0.6381778372350424, 0.2330316227744677, -1.4352419979585818, 0.16419471034999022, -0.7915389172630694, -0.6948397521850852, 0.07225300441638238, -0.38720551202450365, -0.6728173552043433, 0.4901584593555044, -0.3011911410843824, 0.7385324537435384, 0.5135692392746081, -1.014527389683975, -0.12806734801211134, 0.8947288895527266, -0.41719663434970733, -0.264323790226451, 1.2222231079275094, -0.45873271169013585, 0.5491998334255793, 0.9433566704060855, 0.34648747757887566, -1.1876937440600748, 1.474015249455322, 0.09109690818037172, 0.4762043999913017, 0.32370374791086787, 1.3300052480404665, -0.9035152561920279, 1.2145206114423777, 0.1662960823769045, -0.038035473983068814, -0.8691585382449253, 0.7297825970689191, 0.5539414011757895, -0.24531662766430357, -1.8611842544645667, 2.264001141849284, -0.1285518586399329, -1.061587551344904, -0.6400028839006454, 1.2419518343244151, -1.1626233765133123, -0.8609364913772182, -0.4747480264237737, 0.7924355766912372, -0.41993676200760877, -1.2080210232218964, -0.522771713942136, 1.1123743652529314, 0.13439246048987885, -1.2680163959917452, -1.5178202349751027, 1.376334982202017, 0.6307198091442936, 0.05549302512813056, -1.0686895721112073, 1.8553057800958037, -0.07657497922113744, 1.6509036009339446, -0.16853202787683869, 0.8873551158619715, 0.5111586347752017, 2.26013876968365, -1.5732832259412448, 0.5916321653901675, 1.1604203347083761, 2.1410439847359592, -1.1945292731945865, -0.2989815948512669, 0.11956648556291227, 1.194359507848758, -0.3063587687625274, -0.2014486463935628, -0.010036980004349175, 2.1541959314321693, -0.6644399373890436, -0.45264253982439495, 0.49229786229958705, 2.062583692251928, -2.3871507591929957, 1.1674381706996366, -0.6915695219590423, 0.35323240486943747, -1.4239341368289293, 2.7103666366073416, -2.433204259412592, 1.018164627705292, -0.7796438450993632, 1.0084531182306198, -0.7262686188206089, 0.4747128362904275, 0.19377189308116488, 0.8327749707043155, 0.027006377087351374, 0.4920419429743739, 0.8099343165676675, 0.06362930710748911, 0.8886857180922212, -1.9899376495558816, 1.4348774062302203, -0.37058432445486456, -0.6074230283353201, -0.7461731657530539, 0.2955136828318024, -0.12243975675380259, -0.32089612315342664, -0.26116877100980307, -1.0399351192860378, 0.5685917640668027, 0.26565142717692347, -0.047480407418915335, -0.917708687619603, 0.04526293877810442, -0.48907306243998405, -0.39624933700767817, 0.07534048935961551, 0.7926804038979568, -1.2706494460284674, -1.369499156129815, 1.1437020737485892, 0.30992699291065084, -0.2635641804911027, -0.5773946843371726, -0.6299852742941248, -0.9180875161078311, 2.4689739568152222, -0.13210178880087983, -1.845173431533222, 0.37150815563832557, -0.5992039714003623, 0.12206319978685838, 0.9390087815244457, -0.7566959672533295, -0.7911639176905774, 0.15353026765744826, 0.5165121888234734, 0.4663144032453676, -0.9190389247403032, 0.5807754865030071, -0.394656988407532, -0.05425726970675279, -1.1555150183617127, 0.8848779313674929, -0.8636696528304748, -0.16928432805813648, -0.16763913255624627, 1.6683024663642143, 0.19155381147422385, -1.2492382243968811, 0.7280531105390031, 0.861428431384189, -1.6790742926904862, -0.8102664547624271, 0.9918779895327141, -0.9684231164377399, -0.46191880541173835, -0.469428934599382, 1.7911903712519333, 0.4026694957482904, 0.561331111544149, -0.262692085780007, 0.6428361177902462, 0.17572036643054278, -0.5531552502740675, 0.3911023740925468, -0.8597473356654618, -0.40833289137182927, -0.4112232655636032, 0.9298367515911447, 0.285114778965066, -0.3640865314181246, 0.7976414186034599, 1.1090269985616468, -1.7314036928369463, 0.5611399724036497, 0.49388136101810326, -0.9562265528559304, -0.4950508681561445, 0.330985724297137, 1.5843861327086097, 0.3429604179708706, -1.1423128529279223, 2.0672110421376817, 1.7532054555514707, -1.5670295005233443, -1.548234837779649, 0.36389207032794524, -0.2422275478491713, -1.4970198459409518, -0.8014763795234627, 0.5001910333402746, -0.43916231627165025, 0.9246676630109228, -0.07660890473600332, 1.0419230544437714, 0.032294594567328666, 1.415752284775885, -1.1783452806246013, 2.5432823417967323, -0.7315434800527361, -1.0881606023556614, 0.4494940199584333, 1.7595348923797833, -1.1876088074142304, 0.6626568077248473, -0.810897005054354, -0.8541533185324427, 0.16467456380938705, -0.16055426143648613, -0.4113095482674135, 0.850145494636134, -1.195543672315687, -0.1610514529343945, 1.8573275948187027, 0.5071976176755761, -1.9748612716888798, 0.8006661344860972, 0.509057564687142, -0.6418059646692343, -0.7344656678925693, 0.33164558648450476, -0.5027345687000538, 0.15318156682904105, -0.5161185998775313, 0.6822514470921225, 0.03403139481012375, 1.016891733931033, -0.4047921672113567, -0.3163620469171568, 0.592592160835345, -0.9823449343662793, -0.9115926865305021, 0.7748306701573637, -1.7190702051490099, 0.6678670029967922, -0.6088782922598863, -0.3080592423404507, 0.6056494886773034, 0.145056692656509, -1.2938296627981645, 1.7168235438106947, -1.318008433499869, 0.352132242901209, 0.7649190602663466, 0.1621713530216169, -1.8869647462509191, 1.7881317426129666, -1.1528795001553898, -0.1719341758896376, -0.38382342476516007, 1.5702736517138707, -1.7834791938480492, 0.37078392176965347, 0.2866124694251451, 1.0763924878609255, -0.4560785687080029, 0.35877828959427693, -1.4480950633252043, 0.4938322975855622, -0.18975630439681168, -1.3872566033707183, -0.7768033224252451, 0.4372212003537231, -0.9957803223840991, -0.9810201594527637, 1.4037309010062284, -1.161231257986468, -0.23846838125882203, -0.09529522313941964, 2.124290486480011, -1.755523973737628, 0.39809774669268144, -0.09739459629797191, 0.7377458336977016, -1.3730152312454653, 0.5764487884369035, -1.06021938810066, 1.1666757556763658, -0.7540363000762902, -1.1889438331442952, 0.32205840978373756, -0.9019589880013343, -1.134649338848809, -0.20752358629597306, -0.648909878467048, -1.3429324267385843, 1.4478992892850593, -0.29511392540434944, 1.103203552753392, -1.9221229902749506, 0.09838501785701581, 1.1352136290856334, -0.27300909406947826, -0.9916604269093036, -1.173898851863136, 0.23789695998684268, -0.11372150306940104, 0.9261769448956244, -1.343047839107179, 0.5705453021883221, 0.08114342371019015, 0.4853065836712669, -0.7520038939889082, 0.6310978620921657, -0.3353941677600458, -0.19144926604417675, -0.1794231004064727, 1.2948932008320302, 0.3139895295517291, -0.7788398467892056, 0.4430086520429022, 0.5973399941536114, 0.3270212641318414, -0.1940555370304945, 0.2749653599766677, 1.5194685441429, 0.2763230038262343, 0.6246685086945227, 1.3859039095327987, 0.5238528217671239, 0.0780960058804197, 0.019998476751236005, 1.8260947291275855, -1.9256116603358766, 0.9330454665203242, -0.04881641479611355, -0.07884282216745148, -0.9662724977490124, 2.382782245815282, -1.79292073424571, -0.054120111514871186, -0.18528013957757272, 0.5106281647207083, -2.2515854428887048, 1.6549545778507477, -1.1363503272635755, 1.1083768050865677, -0.14903487009050626, -0.8658823291442237, 0.3831946308417486, 2.1907494409922337, 0.7696534232953508, -3.291009339480941, 0.09867044715644144, 1.8415871513115718, 0.5416787294115085, -0.9402379732727032, -1.7092529323991696, 1.0875684839489363, 0.19315938177536057, -0.07248269960154707, -0.3093895393873673, 1.7527396126091879, -1.7896959875020664, 2.0086444892825392, -3.0148653149324507, 1.8617763833715162, -0.7877280100514501, -0.10553719531623153, -1.6335212403329549, 1.7759329421010062, -1.615385826526604, 2.1947837249600717, 0.06355165247137458, -0.022208938503132936, -1.0937888334561738, 2.2313416950067055, 0.347432627329901, -1.0377662185363596, -0.8820344847524124, 0.8694937890194152, 1.2025656948395713, -0.3402348495946574, -1.624131917561281, 0.7143739094701733, 0.0016533992230313432, -0.10227592131589383, -1.1710553032440736, 1.378158242925202, -0.6914565178317221, -0.2246007712733548, -0.1863010706680241, 1.5566750276982397, -0.12253052414943888, 0.3995722981037894, -1.1064977787647476, 0.5349384157026222, 0.32804909920409275, -1.0390906641144526, 1.1339290118780336, 0.4446311904323954, 0.5531057142522672, 0.2905875049095112, 0.34720715494892285, 1.0960895317959487, 1.3027079535519315, -2.2616334171352195, 0.10661675995757139, 0.2019106422835133, -0.2832297867422384, -0.04874686283513249, 0.642302649479463, -1.8387213645106888, -0.436658720652203, 0.7053423550395712, 0.3777987117726671, -0.5860181601314098, 1.3944181873489496, -0.20754529362198737, 0.15464707733004324, 0.906522593677463, 1.099642767048102, -0.9156679415091893, 1.1011660350782828, 0.4466950946749566, -0.7210536778311594, 0.09876924487243544, 1.8877360632360736, -0.9653072851156723, -0.20274881975872083, 1.9436324209223765, 0.11738850193663444, -1.0618244178794125, 0.24487815356908538, 1.6426671583543522, -0.26558627174792415, -1.3492499916514424, -0.3205431507585858, 0.6978747173213024, -0.33106562326915917, -0.6797692076871927, -0.45301845563213944, -0.9443875615017729, 0.47819412501519865, 0.9850816245799462, -0.5591131490515016, 0.570294288271215, 0.42722726273957495, -0.03804845434253823, -0.7016245301559076, 0.28712255368404804, -0.41680080020531396, 0.6524371362520306, -2.8602326845318546, 0.5661118464868093, 0.6060717788106024, 0.1189996097497279, -1.6638490725908734, 0.5380124859717922, -0.271961899737052, 1.1158077916332942, -0.4627211300248431, -1.6990953827003015, 0.9695288002431932, 0.4357408514724114, -0.7344861195579796, -1.1176402566751453, 0.08907621516229275, -0.08564592082081507, 0.5137656656781129, -1.6606401985817207, -0.6000797814613301, -0.15761342689085855, -1.4610831659752106, 0.7950225961846895, -0.05286201814945973, -0.6086633831194265, -0.2558950919217588, 0.23570164185632822, 0.4097888777568631, -0.1663341989299036, 0.28934940372380447, 0.26616284217138114, -0.7338725568823794, 0.15324732319015164, 1.0569797467816318, -0.26735209419820405, -0.8129252327780797, 0.08315373628045283, 1.534367773114349, -1.2903277533759039, 1.1124121098741058, 0.17401246049836808, -0.06333772937188296, -0.11266558029886459, 1.5010251967630464]

# create a bunch adaptive filters
#filter=pra.adaptive.RLS(length, lmbd=1.0, delta=2.0)
filter=pra.adaptive.NLMS(length, mu=0.5)
#filter=pra.adaptive.BlockLMS(length, mu=1.0 / 15.0 / 2.0, L=8, nlms=True)
#filter=pra.adaptive.BlockRLS(length, lmbd=1, delta=2.0, L=8)
error=np.zeros(n_samples)
start_time = time.time()
for i in range(n_samples):
    filter.update(x[i], d[i])
    error[i] = np.linalg.norm(filter.w - w)
    
print(f'Final error: {error[-1]}')
print(f'Finale filter weights: {filter.w}')
print(f'Execution time: {time.time() - start_time}')

""" plt.plot(w)
for algo in adfilt.values():
    plt.plot(algo["filter"].w)
plt.title("Original and reconstructed filters")
plt.legend(["groundtruth"] + list(adfilt))

plt.figure()
for algo in adfilt.values():
    plt.semilogy(algo["error"])
plt.legend(adfilt)
plt.title("Convergence to unknown filter")
plt.show() """
