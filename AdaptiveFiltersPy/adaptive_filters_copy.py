"""
Adaptive Filters Example
========================

In this example, we will run adaptive filters for system identification.
"""
from __future__ import division, print_function
from re import L
import time

import numpy as np 
from scipy.signal import fftconvolve
import math
import matplotlib.pyplot as plt
import pyroomacoustics as pra

# parameters
length = 16  # the unknown filter length
n_samples = 1024  # the number of samples to run
SNR = 15  # signal to noise ratio

# the unknown filter (unit norm)
w = [1.013471828080271, -0.2340543378069018, -1.4353633637660148, 0.21967120868139675, -1.1761841083289097, -1.4467449731584463, 0.12952584546048015, -0.3092670381755754, 0.13673433827957304, -0.17631158104233208, -0.7330297141825027, -1.0760529007308517, -0.2852774810393807, -0.28718014662788943, 0.2651026254581646, 0.35109705671308744]

w /= np.linalg.norm(w)

# create a known driving signal
x = [1.5060195602877795, 0.5853793942491966, 0.8295547532605325, 0.1165689053123043, 1.860712456363107, -2.1050767383249402, 1.7840869307124334, 1.6680450437073104, 3.494825309011567, 1.0861430858857348, 1.0153592821616082, -0.6581973845998401, -0.7504330800693111, -0.45510125071490487, 0.13441332142766838, -2.8604014846083716, -1.324835547193725, -0.8617999617605469, 0.4187121459546979, -0.4786030965885009, 2.074728921761099, -0.9057105756159032, 0.944711936722503, 0.06818539107884655, 0.7677325163456461, 0.008646694976852746, -1.1144057996894916, -0.24940921535200902, -1.606438197423162, 1.4924537799510968, 0.14568754188505903, 0.2610780864746274, -0.7221575539760835, 0.7092439275580441, 0.668902489970409, 0.003862710989984676, -0.19888575916245607, 0.7847427222680905, -0.7334290437136206, -1.1787560310427556, -0.565272269731152, -1.062428047754479, 0.42549102464150435, 1.0209077061088547, 0.06470547341835028, -0.3520356407545513, -1.035941188676513, 0.847698640861382, -0.8016796818654618, 0.42233737708471947, 0.7610945633623264, -0.07567777327325292, 0.1971883970835762, 0.13832440528460668, 0.5770865000601356, 1.0667025807535306, 0.9507319977532782, 0.6755414678809221, -0.446433311644281, 0.03497127242565364, -0.6488153599249638, 0.045431655599081966, -1.3406498507046118, -0.43699389599279775, -0.9244888339402038, -1.226947590272008, 0.055827867910005886, 0.440743021683517, -1.973857372077689, -0.581933242951131, 0.20187907955459694, 0.43823246307824254, 1.4198002246149382, 1.216431984123361, -2.051657467190224, -1.1784182919346384, -1.6197109498408473, -1.7428405815281718, 0.20814278860075128, 0.40793817695970963, -0.12304105736881504, -0.8914331136690282, 0.31048098818917813, 0.06418847544742999, 0.48749285835146144, 0.33875889534518744, -0.19074310024097407, 0.027766660135015157, -1.168801328762577, -1.6754541038777293, -0.6562339729225568, -0.7560496312995075, 0.060728822054466856, 0.14035555051288756, -1.0968197994609357, 0.9356182968522596, 2.8593739234914524, 0.3236584275064499, 0.4496328549979948, 0.18094703488694017, -0.45985003017218695, 1.4346468279669211, 0.26979056411845515, -0.40178967670295584, -0.49387271316434495, -0.03287674769929515, 0.8654526954698122, 1.233117302015756, 0.3154850528038183, 0.05905867480111459, 0.6503411071702279, -0.5659883842322794, -0.759035618376106, -0.23041994789225537, -0.7595765613729354, 3.4658450055652956, 0.11570911699578004, -0.2871697485183492, 0.6196620672825909, -0.4747453247056648, -0.2055897353381471, 0.016569156156564416, 0.09120923343965148, 0.144430376864455, -0.4638909452438446, -1.1493571731271925, -0.11858747087965527, -1.414489097011296, -0.5126889637052631, -0.7605340356695021, 2.041310497483931, -1.3246891039741526, 1.0843833056594636, 0.815559211514924, 0.6247535231390363, 1.112750506388233, 0.973808309099054, 0.8988944953603362, -0.0378148562510531, 1.1859258698383732, 1.643504955179611, -1.7942710236124269, 1.3097083646110494, -0.25780582371287175, 1.6251944589739649, -0.30469654148256475, -1.3141953563784763, -0.9177230260312532, 0.7673596860055385, 1.563400135023938, -1.2813903015570172, 0.9341378500992819, 0.1050659285306231, 0.3498184517563585, 0.3546644175878719, -0.20450080531147136, 0.1832042804546088, -1.5688416087393022, 1.2270939865966737, -0.9978237895900487, 0.4513965289870181, 0.5955854901254098, -0.037896099656693896, -0.27912163953199554, -0.6299635953223305, 0.415337019392131, -0.7731971604325908, 1.546397371695539, -2.6835919781635176, -1.8955817031447226, 0.9363964267902798, -0.027405757827753608, -0.46374400580500297, -0.27305988417483773, -0.34231981701885433, -0.8977486193918313, 1.8450903594559689, -1.4612953572977445, 0.9479674184681839, -2.1697837691458473, 0.21562707598954897, -0.052011811415510346, 0.8176742657477681, -1.2552924129950114, -0.8043796496506862, -0.2554029095238541, -0.9242595460097801, -0.7820554477424388, -1.2947687574863578, 0.4252247944987374, 1.0105709936748777, -0.5398981902836754, 0.407755395654154, -2.074811965976392, 0.6534651661499925, -0.3690796471280464, 0.11743645751819977, -0.08688597821830031, -1.0435142933509969, 0.6283420323799196, 0.9514440043361113, -2.3301193018748547, -1.1738430486221343, -0.11537321674675903, 0.6101293707335296, 1.3471005457802394, 0.013713164519078665, 1.055890064210422, 0.4102731184209637, -0.9797240291860368, 0.1634922479727676, 0.9237373403233043, 0.08226187609331434, -0.27222053955177034, -0.6074096611875098, 2.236630155304213, -0.8674375501947971, -1.214081732168653, 0.5790153883210455, 0.8196842340060989, -0.8574457608220205, -0.4792873244554359, 1.5120543238698998, 1.210433047890221, 0.5092097391436273, -0.15938759341087325, 1.9577831771736125, -0.0005437200209645599, 1.0758662148491944, 1.3574357623479412, -0.08753769712811157, -0.25135615607952416, -2.188133257693862, 0.5725812586148683, 0.08069178548485519, -0.663982737260246, 1.1571012800593754, -0.46018133669237693, -0.5023609046959627, -0.20774318655243196, -0.8193381875466228, 1.5254316609338978, -0.33715275725939, -0.09171372829384206, 0.6512861912050375, -0.3381248258481419, -0.6677860704417651, 0.44266928584000687, -1.4883345534482577, 0.18027816394757423, 0.1867842942797108, -1.154470294143004, 1.8566645738320526, 1.047549733156952, 1.089501419135391, -1.9370630735585856, -0.8868588281290402, 1.640683820750105, -1.049811511811532, -0.8391394746292168, -0.1891815000826776, -0.3159459838537862, -0.47254369066744467, 0.13194008098390092, 0.9420771124230435, -0.492545377678464, -0.07190589752402676, 1.1389979822186533, -0.1607902724583392, -0.6713367227714347, -1.3835586613915754, 0.4848258391918754, 0.8173802213093626, -0.8287742934698004, -1.12239241329283, -0.4862275447999816, -1.5010753366753866, 0.2479474115673375, 0.09665354052677637, 0.3088039760130493, 1.9127363711127972, 0.28956357238613467, -0.9871752538916304, -1.2193767112521843, -0.7973509735732234, -0.07513965924005443, -0.8245044104978502, -1.200351312629947, 0.9750969099510681, -0.03466195016734196, -1.0762290771565166, 0.2951403800841446, 0.1167467944514834, 0.1287843589295526, 1.4375419283744189, -1.5909472594827052, -0.17274268853999508, -0.41525056029520446, 0.47184868069335445, -0.19915836754798588, 0.3168199131603115, 2.347336096343694, 0.823764518139827, -0.9239936964811384, -1.2055253889393278, -1.3378918151570052, -0.08119137104659262, 1.2819093099463188, 0.06352150261546875, 1.5075138623817843, -1.0918830101451606, 0.005004373160120157, -0.4522214442597394, -1.722888944152237, -0.9046570867812093, 0.08737933743358801, 1.29686820124551, 1.0508865913508416, -0.2904255962665088, 1.1738849547793957, 0.6808992175609107, -0.410963248026328, 0.3654137826970448, -1.70157980877248, -0.44763945161459034, -0.3661648260533106, -1.0210788536829123, -0.8771192800004309, -0.5947028119253345, -0.7619251538403741, -0.5590600390759041, -0.790239451759662, 1.1002287522931529, 0.4017758715765736, -0.8392856682397529, -0.6530529098180123, 0.31968845253939393, -0.8406059632124434, 0.36110778898135176, -0.4100273903760699, 0.36021533411146617, -0.1677415760690868, -0.5141561020112855, 0.8127703548398826, 0.31159936287076034, -0.5353860860746403, 0.8981589846919431, 0.917148084202585, 0.4061602005629339, 0.9784200848729887, 0.35380892935439606, -1.8980953668723823, -0.5429372068925968, -1.334438476805051, 0.538739682714779, 0.5325706902697781, -0.9858655735674479, -1.1618330681104194, 1.3520693217025896, 0.723894473360055, 0.523700026938568, 0.8918053863532542, 1.5008799092176404, -0.23657960967543, -0.3900629500900634, 0.6387331823510918, -0.31515230485188034, 0.4744197575515938, 0.2831216070700221, 0.2903695402337309, 1.8459422928430058, 1.6905452367923886, 0.1999302191667952, -2.3961498603789195, -1.7498117618914717, 0.7764730084954595, 1.7617666132941852, -0.08157579746650442, -0.5234667891455232, 0.2700466793711566, 1.4527740956320847, -0.4134875391141469, 0.060286258027026605, 2.6281404097623935, -1.7674030570953094, 0.0048591140904975, 0.14939167256099684, 0.7606215779450721, 1.1837408245527377, 0.5809070137829273, 1.0827152697154627, -1.7862198006639094, 0.569523260861179, -0.3401121237019365, -0.42220587385329433, 0.8082089914753313, -0.10844797558821782, -0.9163408771711475, -1.0216114140729518, 2.2207809410659207, 0.9686676690287277, 1.3413910270782066, -0.8375022789134023, -0.05832012813237676, 0.4799412305273861, 0.16513238343315118, -0.9737149098425287, -0.044392898594525304, 0.727979228968715, 0.2971739219270154, 0.06118376329125195, -0.5031933025180266, 0.21187111455684052, -0.0718014755675316, -1.2348951989802424, 0.8468852063459804, -0.3623234338827643, 1.1373710315829855, 1.2523587082147896, 0.4890622514368073, 0.06851796012697213, 0.3475518344975049, 0.26250207349938176, 0.4599470492718796, 0.0021873733528394103, -0.9477663807268594, 1.1139326381592682, 1.6169647396454208, -0.08462417298677682, -0.08891008705444257, -0.42717369272916433, 0.2291814984135814, -0.6050079326282806, -0.622341847191551, 1.3607948986371163, -1.03492866301472, 3.2468349360846718, -0.02062648475811331, 0.6375190324291178, 1.0019814628108024, -0.505322807721683, 1.2142587184298972, 2.149115991493389, -0.3170921535531649, 0.957122920934855, -0.5621817630096312, -0.9398513038167394, -0.6307840539782905, 0.4644918722690331, -0.12980124770438675, -2.5248535370778598, -0.21887980348015265, 1.7530925031731177, 0.7596859790068908, -1.3919980777366066, -0.4069775209562326, 1.4084054100404089, 1.2454385143097897, 1.3776071594444206, 0.6535083539757655, -0.22617803565380876, 0.219741420711299, 2.0252181612315083, -0.6808889401007141, 1.54905421114828, 0.713616310714712, 0.1534949402334457, 1.0194648851044477, 0.3905801037887961, 0.8973991565584485, 0.9630658151908658, -1.0279860526388178, -0.1601801442423411, 0.7603362711779156, -0.5217617528391031, -1.5355580932564608, -0.26819630585526255, 0.3143936751609116, 0.4786142334476979, -0.3076377181160573, 0.4026604763989608, 0.15583510788649008, -0.5260715591144991, 1.5016831314712757, -0.8617032954842136, 0.2589387245884135, -0.4347489818330228, 0.31042449316128357, -0.10065594648289332, 2.7579950254748002, 0.27568840576988923, 0.01986941706512411, 1.5500645591764128, -1.120582409332352, -0.6044369951431299, 0.8532362222965341, -0.5953717725868133, 0.4366472402266913, 1.2407998014292876, 0.48636871155997674, -0.10375405096598216, -0.30458486328986917, 0.6696153984187374, -1.0472140884235828, -0.646245892764979, -0.8708694023903811, 1.3120822549090694, 0.6786491726546834, -0.09349197949110793, 0.636163819038298, 1.0924329869759493, 0.664962633745844, -2.8197602322660544, -0.5608091633268818, -0.7030981034659367, -0.022648490110305505, 1.6381843713083168, -0.6098028389379748, 2.6727198037458293, 0.3218739199970772, 0.18124750869262485, -0.08234393583816527, -1.3270293004565363, 0.20012160161451908, 1.2482813873947476, -0.5588636692532908, -0.22126518264237657, 1.3995177132694798, 0.5486679505773177, 0.02724074985321854, -1.5723819860815806, -0.2188628167991205, -0.11107237904380567, 1.2347814480227925, -1.0675548280572467, -1.2429178562109429, 1.0993191427408198, 0.6526713364720154, -0.8375067982822049, 0.874966181936111, -0.45997933721967177, 0.2565558604875358, 0.6112137141272447, 0.8326876170670352, -0.7310214637864317, 0.6363905340332534, 1.0810816277956081, -1.4433334108585791, 1.0558134518468147, -0.22911393442258243, -1.6198304316500678, -0.3022750424931124, -0.9688688178866495, 0.258785446110261, 0.8539019422143596, -1.1061132294498373, 0.8561393748328511, -0.28338712272983263, -0.9066417462119647, -0.18491482825147504, -0.05367840119170722, -0.2920911741140329, 0.3770483286227844, -0.043646576260646705, -0.9909746581388468, -0.5662498021416285, -1.3901856618234323, 1.4648056578993542, -0.4054946448741091, -0.1585504151559501, 0.7672928956660927, 1.2626165691618143, -0.0948031954336473, -0.6619993188796325, 1.650918171104133, -0.5613114153792614, 0.3288358213411654, 0.6028347145257019, 1.1867204498001278, -1.4765861034441357, -0.9558671246832031, -0.22898663616671586, 0.02165788534610864, -0.18111345703651552, -0.7969309356702512, 1.1041255444152374, 0.5196212031318728, 1.6268066942464696, -0.5609923141148296, -0.6717869102209664, 0.0671712610950218, -0.6588203835787974, 0.7471713818785252, -1.854826777715274, 0.4189524068109493, 0.8522587198451463, -1.1565819433526643, 0.6423723379561376, 0.7459609432856865, 0.168139028906102, -0.7393438660062078, 0.9633633142818988, -2.0944892949977536, -0.23608858736538513, -2.142070794540594, 0.14817857298699408, -0.6168435429910971, 0.6765068080596345, -0.2619889490616475, -1.2331717854173077, 0.09747885575795753, -1.8531490498258296, 1.8498849092169225, 0.7964439212284384, 1.2597556575579902, -0.5921982600582222, -2.827454548053048, 0.6219523509643159, 0.9534147015181497, -1.0820865289895107, -0.0352415125739579, -1.72263282569764, 0.83576252519655, 1.4922140326251856, -0.7428292957735056, 0.9494702464651218, 0.23174501184426835, -0.16957893032595786, 0.12721211807761382, -1.5746905891385863, -0.8921030194630327, -1.241885366731224, -1.293171183577862, -0.035249095904918114, -1.0222567901546937, -0.2172966041214653, 0.891499394317651, -2.2948507007720873, -0.6041267315270219, 0.5823563511985197, -1.4979084635591198, 0.40084369956448596, 0.50364107629814, -0.816610103219989, 0.226906388624843, -0.7392652102362823, 0.3868055535453351, -1.5709319635354082, -0.6574674011489549, -0.18901082607079023, -0.521208545524663, -0.14150510244511363, -0.04231436299236406, -0.1175157798180059, 1.49691442587179, -0.0997815868913109, -1.0967673013188857, 0.824476598345231, 0.24011789013201554, -1.0013827932158934, -2.1622537680986045, -0.4108636946003367, 0.4645533571107618, 1.3535978900926182, 1.036960959529391, 0.36696977291415395, 0.30909552790692607, -1.2266885892853356, 0.6763959045378072, -0.09808558438720331, -0.4807237915948809, -0.24641299334113875, -0.5156295389822076, -1.0699758551660892, -0.496809842140212, 0.7043128467646623, -1.5384758562822627, 0.9312636103742653, 0.06119084428498238, -1.551859006103299, 0.25387710954603604, -0.21606968389363954, 2.0767749186759463, -2.043993111202757, -0.9034423876604016, 0.6925225911512507, 0.6403406269151605, -1.8915425883508437, 0.3120729666203207, 0.010523274846958638, -0.6813247880112981, 0.872326457029693, -0.7817723355352346, 0.8126963021416763, 0.053567227941929384, -0.0685603732678387, -0.44007030989336093, -1.387234848937495, 0.34660862218805705, 2.0884161059946726, 1.5829300729903086, 0.36442450401070414, -1.5719055495177248, 0.059059584471148195, 0.2767118852263915, 1.5614239467464226, 0.989066697924858, -1.469108742937939, -0.3646287476151124, -1.3963544797367067, -0.0001569396150392256, 0.5641483442181284, 0.5613363725603949, -1.2072302930674375, -1.106479851641533, -1.3815806551356733, 0.3322790517477639, -0.4888987872010805, -0.890791088070227, -0.8954379403400535, 0.9536029292858236, 0.53061798784833, 0.16063953408094434, 1.4052923687646437, -0.8018860083626779, -1.174921107435024, 0.9494842180496953, -1.7332873664649109, 0.4871886645316044, -0.3193733107427478, -0.1275364465367413, -1.543181541896644, -0.5103451810994658, -0.5694874644105937, 0.12831519188428658, -1.6326882238179492, -0.20595604721116792, -2.181468085423434, 0.9133752394403403, 0.3293804543684295, -1.5297862731162217, 1.3065398094105352, -0.353658166756196, -0.5606974295389915, -1.122699390909927, 0.9778570713093137, -0.8998188316245501, -0.584381342033955, -1.3900462585834348, -0.2152327758196777, 0.03297940027939173, 0.2490942858079406, 1.174085998788011, 1.5335286522228897, 0.47002218013142405, 2.3823716297137034, -0.4176344608736915, -1.2509548404944144, 1.4387107321198054, 1.1641308461718183, 0.2546664268543401, -0.1565866690063036, 0.06542449510252155, -0.37088350335360865, -0.7851137247105261, -1.0919601262665555, 0.4099328259573631, 1.8810682754120993, -0.9496005986171864, -0.6866292816973392, -0.9789638714233013, 0.935439387723065, 1.2139613064547838, 2.9067308723180783, 0.3754515463033019, 0.2969711573456836, -1.9990928338835252, 0.5873522890411061, 1.2820706342360557, -0.6299570113659021, 0.13434827935149693, -0.735066959023982, 0.5657807193769907, 0.5428854131318627, -1.2932056878069467, -1.144276218829407, -1.0023534593040453, 1.2080257998691655, -0.5233414388466251, -0.07135324976542536, 0.03124674400182298, -1.9025684628914568, -1.362115706026647, -0.2626087427764415, -1.0746009201250295, -1.3664309238384067, 1.0891833586308142, 0.8215098126802607, 2.0233274118348996, -0.2048967518707505, 0.23705765398674464, 0.39062320289871905, -0.774260265813247, 0.36312353004644726, 0.009252690799451709, -1.462876003828203, 0.5958753717111012, 0.5126690303390508, 1.6164015271298346, 0.7323883979852243, 0.04442896989299001, -0.6772595231735739, -0.03667041798075138, -0.3192449065336126, 0.879036187281969, 0.3249923130274311, -0.21040872209197584, -0.8832939284209483, -0.959043641924081, -0.12228825348118827, 0.3162980560235968, -0.21612126698660103, 0.2915718920658338, 0.39992720331675036, 0.9903876139739372, -1.1469901546718155, 1.2466367847639799, -0.24233474510588413, 0.26305089231572254, -0.8381903727367064, -0.30477728554045364, 0.3142460415672019, 0.7441220696327634, -0.5477160473510612, -1.6827173483604378, 0.10662996304938799, -1.0567491989381574, -1.4878214486013444, 0.8833983392869995, 1.305975433381766, 0.25052301868565446, -0.9342048792716926, -0.7058352929662114, -0.3063300368036378, 1.2358435311769984, 1.0462756020491053, 0.9881390052556195, -0.6729061606432595, -1.4205445281315792, -0.5877156623992779, 1.165601752302523, -1.0732662855809627, 0.9841260403101826, 0.839589526604872, -0.48418273983069254, 0.7400166333400926, -0.2693103366046375, 1.0464595892929742, -0.31750565308179274, 0.321288214888027, 0.5275773787973741, -0.7405045098165605, 0.4018101808179351, 0.8210883042696279, -0.7715802254849001, -0.4624878235976621, -2.15121055765713, -1.2721907348473633, 1.71704443386894, 0.06311873971884503, 1.428232628068271, -0.9715111236739735, 1.3437434138027746, -1.1605749216512427, -0.9024106404560143, 0.39243030952635094, 2.937985549740268, -0.5960726896851771, -0.6300023133353344, 2.1099291897693373, 1.1030294486532537, -2.0193698807388554, -0.3467104896211165, 1.2359392137151435, 0.20461055617754453, -0.6160803657145514, 0.006436938122961169, 1.0748239543884834, -0.9224927870178321, -0.24116792353906208, 0.591394931128527, -1.5918510183435581, 1.531702179167341, 1.6532740867640787, 0.7262498794855621, 0.5467945531315329, 0.11928775015454607, 0.9730911697808479, -1.5731280403492809, 1.6891523979788996, 1.1405408474048189, -0.2040242620145659, 0.2480339913429808, -1.240632126599629, -2.193455736753838, 0.7257800785216867, -0.9778958209617505, -1.3709855600346803, -0.7860824895223159, -0.2545557462872792, 0.40639105154024024, -0.7438376755430025, -0.3127744589098636, -0.6218959396381053, 0.6724071379677412, -0.09600354815906624, 0.8255536682354225, -1.3539646883278882, -0.6893045075929947, -1.2152716596405517, 0.5993568559420959, -0.5857012650132096, 1.6909529065221918, 1.3645865210889576, 0.16936826214050626, 1.2578530139685407, -0.9936473698557525, -0.44133901348265264, 0.011178243122704884, 1.9689918618923214, 0.2915121848074525, -0.7322551450329917, 0.22442382314358073, -1.3985642716102473, 0.18302600382805279, -1.3893230197407962, -1.3355145894318914, -1.373263349903951, 0.5601478600457358, 1.2713389733344964, -1.2599007958781714, -0.28787141401709704, -0.6649470411950393, 1.6835705420128995, -0.03968536476479293, 1.0409343948876064, -0.2964430328160411, 0.5723612978098431, -1.7148468915330979, 0.5257359278201404, -1.0579839960238686, 0.11937192657753583, 1.1606964772372457, -0.40837823586109406, -0.10819423349339564, 0.3300217897540531, -0.11205318013609637, 1.5448723520048404, -0.8935762116878391, -1.3012810372040102, -1.0671387495196178, 1.3951704032678316, -1.576409002654981, -1.3724979792350296, -0.11945233802460674, 1.0909615737879566, -0.5655693221925592, 1.7346596754791297, 0.3900496852575972, 0.8816328988716142, 2.5052879440284648, 0.3099811806523449, -1.125906786920897, 1.3419010315694773, -1.2135152795331428, 1.0948421579452063, 0.32203682640280806, -0.32817722280387107, 1.3513409337883777, 0.42262525901643355, 1.537260685755549, 0.3229469297124777, 1.3562132827385498, 1.3370918233574602, 0.96202120484222, -0.09336191775446244, 0.9636763592845581, -1.3460781857149764, 0.8884049152626726, 1.2658065096303999, -0.07642028843268878, -0.09501358317833457, -0.587414169527941, -0.7675129546912728, -0.6541212247816989, -0.3573362627455933, -1.3981836010742204, -0.6865761409524799, 0.4411455109395964, 0.2194063536026829, -0.32350152377509833, 0.8051050546114504, 0.3974002023020792, -0.4516524437555661, 1.1133018796686764, -0.26118080456106463, -2.299594776500367, -1.1196121401072054, -0.9050655692059986, 2.1233308410536584, -1.1094599607030298, -0.6298291155170544, 2.114230507505341, -2.0726407059121597, 1.917124207442797, -0.09875252468788384, 1.2573124376318705, 0.7239139370180738, -1.6664613271167013, 0.17067253190061618, 0.04907552801640973, -1.0150450429449425, -0.5693293673173854, -0.923904203002263]

# convolve with the unknown filter
#d_clean = fftconvolve(x, w)[:n_samples]

# add some noise to the reference signal
#d = d_clean + np.random.randn(n_samples) * 10 ** (-SNR / 20.0)

d = [0.3718304307453122, 0.2989655112954881, -0.4591214388981198, -0.2779527000413957, -0.5533563455064388, -1.705335099349172, -0.7233170063868077, 0.855365327851735, -0.8365979281618887, -0.7858685549906613, -1.4873579543268836, -3.105892087702927, -3.037331615069363, -2.48089200967074, -0.5200118630574699, -1.2313419973911515, 0.34696709564185835, 0.3925722152903333, -0.32739887923763245, -0.7712292116167208, 1.160811262157052, 0.40593289535233357, 1.0857708420962198, 1.6433832064633536, 0.08873957705351071, 0.08610998741084268, 1.0119636331691044, 0.11435685335058317, 0.29136165538887904, -0.08664083264532953, 0.2621755649267936, -1.0343773019211322, 0.518972229617793, -0.29478568750846285, -0.760920175211147, -0.7012760429031135, -0.11545169055013024, 1.0169246211103067, -0.3016086525143414, -0.4275796494089949, -0.34062539870053676, -0.5667256914271428, 0.09671096547597438, 1.6731598130055938, 0.08986551879701818, -0.04642063688643008, -0.045276381695789486, -0.36911389993677673, -0.09059256323108213, 0.6390239360237041, 1.5120637739829887, 0.5788060580194693, 0.07006971333907905, 0.0943423170742976, -1.1509051389717129, -0.25296787919316954, 0.15051934273904377, -0.16607785016118043, -0.6607652086088354, -0.6593782795600787, -1.2512742650573951, -1.0089491155031713, -0.4504269610855065, -0.32802200942307624, 0.6939886409793847, -0.30783708738600774, -0.07116748198942979, 0.7032662402811279, -0.6352163322213982, 1.050324192038495, 1.9951090437236192, 0.47345228089979574, 1.6093496733702672, 1.9182953941896372, -1.0203400175249797, -0.15661408222661527, 0.24486410068265624, -1.2907075049801704, 1.6384949235486803, 2.5908677201222483, 1.0778300347557577, 1.237721974252417, 0.544763257101941, -0.6324652151592044, 0.11350375896440248, 1.4775419154085312, 1.226056090398141, 1.506719206160517, -0.00016199270716132919, -1.0863886192777577, 0.4558721488943864, 0.0378838123982595, 0.3954351287266925, 1.7509308930372676, 0.41167277924565876, 0.4729539048628238, 1.4815487983493345, -0.8235101867331263, -0.12100825050370168, 0.9434651241937576, -1.3362188112623292, -0.15835732931597715, 0.2720196749651472, -1.4873734006458246, 0.12653322557379465, -0.540090710299302, -1.194936548280877, -0.27715264814675894, -0.37885640970549755, -1.0580831717871988, 0.15527552466395558, -0.9835852363907314, -1.8998024364718917, -0.008838894412546039, -0.2475040678542198, 1.388557557384781, 0.6521357749851505, -1.768136268826021, 0.3106914056714326, -1.3353994312450903, -2.7044457763464487, 0.832912982330905, 0.1417673882389422, 0.4454333041526329, 0.39716204932570526, -0.712147542093553, -0.8226927369755788, -0.39619079549827807, -0.5798511166006315, 1.2620401135191062, 2.1467387093263173, 0.2726930411464379, 0.338611076469993, 1.1949930119399352, -0.6815374061240044, -0.0022432177522919844, 1.102262383833795, -0.6222980801105917, -0.16290130229158983, -0.6546503722894824, -0.7099340368340709, -2.7931598714929997, -0.6064237144578641, -0.49381375653634213, -1.727953678854308, -0.9342823850593236, -1.6019373797879388, -1.337636228345604, 0.18598817112440724, -0.5998533357743372, -0.7148103127633506, 0.6444026034692621, 1.1683324759316172, -2.017504250354161, 0.13656543018264988, -0.39150028189352526, -0.3509812623134092, 0.28141785569702704, -0.29879768833005943, 0.07970915694473522, -1.2578094043828603, 0.9006747468824028, -0.39162300650324766, -0.5567385003864654, 0.13239738887729033, -0.4375035865483242, 0.2791502636534422, 0.6084287633504577, 0.09182083054282425, -1.3140875081395853, 1.9804409457685634, 0.15128312648058914, -0.8090579311257697, 2.3901469096478283, 0.5112914442499775, 0.1680969680215845, 1.499823731413187, -0.06460137353723909, 0.2670433314914784, 1.91236969725287, 0.27240831737246135, 0.9588392395859794, 1.0207593227527654, -0.8122279907388895, 0.6549274398079148, 0.5578789454814657, -0.054699482798822724, -0.466053926544337, 1.3674505296212156, 0.8258508059709339, 2.4291331540759424, 0.1380907422622965, 0.8083558791028447, 0.029843187442862358, -0.21865239738576076, 1.0971052974295403, 0.23205850404308676, 1.2359183456399714, 1.0229509168831863, 0.18152420626416535, 1.0262885211386141, -1.8140369395198048, -0.5187387805896287, 1.4428770060678746, 0.743528083108312, 0.9992311196358534, 1.3501057199067332, 0.07346278480995666, 0.16661755720903054, -1.6667762027446813, -0.5221491714963804, 0.49948816900465076, 0.042585150752368, 0.011561805210961118, 0.2597586320836712, 0.24238631174568243, -1.616305784236289, -1.8972101799343744, 0.5105242499868362, 0.2686274254348366, -1.1245827386187315, 0.3134067106208617, 0.9784767931158214, -0.1510693297219859, -0.8266540023972379, 0.08001432599444244, -0.42175277164196856, -0.8724368553087134, -1.5353689164510338, 0.30723709149627776, -0.9888288173004818, -1.585020163544148, -1.336514648352006, -1.4205325020580013, -0.5248170043591517, -1.2068474942261531, 0.7459130356737517, 0.44183971250548115, -1.6952660665785364, -0.2567910853171939, -0.7588221816507446, 0.5133978721924733, 1.1103524983622226, 0.07992045984746304, 1.2032235520448142, -0.05882897014817384, -1.6135174953005884, 0.4391415308938116, -0.4625156841656547, -0.1436625486187935, 1.4853826623016047, -0.30085501456502717, 0.8130244233321522, 1.5040938529171601, -1.336524046560391, -1.0317514897939892, -0.6135626549275648, 0.44054600131042265, -0.7590218032077236, -0.44653137051713043, 1.5731658658779013, 0.14204434873371666, -0.2994191196213315, 0.40696773590681606, 0.10065591383018833, -0.3812037576107377, 0.46668814264821123, 1.0512664880878915, -0.3064622321319968, -0.5388612481244375, 0.14305217276393492, 0.06031376089372492, 1.0423348898326845, -0.46024767101641395, -0.44421841093551134, 0.8710088885445588, -0.5703679847896193, -0.07186306869815133, 1.2680125943130864, 0.6135565404197367, 2.04409262412141, 0.8830464752840019, -1.221102371261195, -0.4811055093168698, -0.4815495151232946, -0.04330014180898519, 1.3895028815609123, 1.0142583536020107, 1.620850815655708, 0.8187345206660659, -1.3078968400875493, 0.20289438962734158, 0.4556185939051982, -0.3250198752375645, 1.7055960723010566, 0.286289024336773, -0.6130217365411302, 1.4741610509722582, -0.47409119248975723, -0.5982016246660486, 1.194939172304974, 0.8684525876046615, 0.17531055293262435, -1.873286078388093, -0.7017026558688786, -1.1603853481684963, -0.3093449449698673, 1.3491076011432053, 0.9729537083834577, 1.1114355038646226, 0.17326256286151265, -1.8773942621037465, -0.931260593427343, -1.261115652362018, -0.2341800450797242, 2.4556576845381257, 1.5758640012120222, 1.114586901819317, -0.03480165919840905, -0.38034810003258923, -0.7784726159245099, -1.2512670413749798, -0.4154479162331122, 0.22069051889333557, -0.4300660790278905, 1.1448572296127018, -0.25522250473335534, -0.42554292898527557, 0.4152647898948221, -0.21976606250750153, 0.33406680902107594, 0.8339129129522247, 1.401955114265412, 1.1812981858377158, 0.7529092424933073, 0.7439588094378635, 0.9462159477091403, 0.02619862271559978, 0.5881299683821234, 1.1260473140355374, 0.5020784359438384, 0.6719542074120709, 0.24728001245420966, 0.019693684091779268, 0.5636133827514984, -0.7695945273781992, 0.8314635980250279, 0.6982193153959025, -0.5793493104312437, -0.18324114721623275, -0.18640602460586372, -2.199825783284852, -0.5194675326539779, 0.02579969892993303, -0.9584427050254914, 1.280422144450428, 0.09787514193374229, -0.48871250474031025, 1.3001624899699424, -0.5234109379060163, -0.9665538836935965, 1.395622719285649, 1.0123708354902843, -0.8896131345972831, -0.2790037794797653, -0.4712848496292431, -1.1892945905464334, -0.30060650113998666, 0.06614148392240987, -0.5658515431960973, -0.20836359520166156, -0.7165718164058607, -2.112338736255211, -2.0269188426042444, -1.1789177119034904, 0.012386542235045046, 0.40720076218472895, 0.2571919580789123, 0.5315298931873291, 0.7253697443987022, -0.8965664912039121, -2.1352404962624476, -1.244816706070491, 1.7232503447336343, -0.2841864448628166, -0.809182825397933, 1.2019810571268477, -1.8528747226105875, -0.9514317465766275, 0.36934720386278186, -0.8081611339500478, -1.2943753169999237, -1.426517146419746, -0.4904252860043013, -1.6204393807997002, 1.2595860525348126, 0.22004247729603993, -1.0374635578171862, -0.32068356401323994, 0.12667578385240602, -0.7022602921822604, -0.336157245235766, 0.654790102603097, -1.1214322373442172, -0.6115398848603981, -0.7681519852681256, -1.5858517560364669, 0.8074890261041541, 1.2532855943721095, -0.37538453706359165, -1.2370971556974513, -0.771420829167202, -1.047538816462792, -0.36870951534675267, -0.5729660390148495, 0.5078960704085349, 0.8132696788601017, 0.21844295980861933, 1.4548058858669564, -0.45074401341911063, -0.8681097130197167, -0.19039711204997817, -0.6254591670265011, -0.5132628846144337, 0.015523896875509507, -0.7720535834064001, -0.16300392655778687, 0.7901098452916051, -1.6671685407733627, -1.011254506251528, -0.3334936689572167, -1.2559353033795082, -0.773487875087011, -0.21100771528919132, 0.7060440780175564, 0.2806994601328189, 0.635053508567182, 0.6118985713140364, -2.7029354539663477, 0.06293367419493225, -1.2276257329726366, -1.303993031003535, 1.2702718529027506, -1.59584278315416, -0.9500313819785864, -0.36284620354189107, -2.654593241681753, -1.8994534914376309, -0.09414398975804472, -0.8336049008001725, -0.6735395777607869, 0.6338555769231492, 1.0628433636798464, -0.8515036640727098, -0.5107624289360284, 0.7984202304328527, 1.0145233793928796, 0.14830236137588523, 0.04126027564003491, 0.9359500441902977, -0.9273179970487476, -0.4070896350745094, -0.6010134243892847, -2.0342972806809145, -0.6537338857780215, 0.18718866348046515, -1.7647694184474263, -1.0526049372259556, -1.2473775016481392, -2.691386162983109, -0.4722669175837283, -1.300664678988647, -1.0558499086629465, -0.18607072037781375, -1.5667348971880495, -1.7516222908909476, 0.406445313793873, 0.059376067796252374, -0.5303413314629657, 0.410456260983592, 0.07143831610710306, 0.19361183656865955, -0.30002789009668057, 0.36758149941454066, 0.1400094092241861, -0.28271104741660963, 0.9664023453219831, -0.13167823972105663, -0.2045875723554192, 0.8618371562071601, -0.3068182510574044, -1.2911836426952776, 0.339541875762293, -1.803635251065516, -2.601959813357135, 1.4453067969906683, -0.9207835191063036, -0.08435351998097748, 1.3708257942942363, -1.2899839122049788, -1.533226256330564, -0.5306849255252057, -1.2270898311747154, -1.2210420649971852, -0.05530072101412959, 0.39346743496936476, 0.8113210057814509, 0.7490833248256922, -0.5221152553400716, 0.1832974242925928, -0.10489125806226335, -1.1003837511500363, -1.5798454109969038, -0.047137643621419534, 0.9036887846084874, -0.2729600555200135, 1.654783158482359, 0.5931871375956488, 0.16437111286972664, 0.4703445844018892, -2.762184606309063, -0.5311902342887579, -0.988462344881617, -0.1580825379300204, 1.8913701373211218, -0.08890828308680451, -0.47765165885122324, 0.44562165700999784, -1.228566752074205, -2.6228746624246924, -0.6020908820106118, -0.5589458721263809, 0.5294733633653054, 0.8391573429320217, -0.007018368865181188, -0.4600908576945535, 1.2125553439260002, -0.3306009311207303, -1.9537842918360762, 1.4527568765347478, 0.17921335910193265, -0.476201305192413, 1.0287829326902294, -0.05707324045109162, -1.4383896266835439, 0.6678829331004099, 0.44964966070727364, -1.4700250964339117, -0.2547975897942384, 0.5571290889959398, -2.251594319708052, 0.7619479028443277, 0.3734650304994564, -0.746576059083659, 1.9884513880994645, -0.020897627822944003, -0.24903602341081119, 1.08046812361946, -1.3924577196281813, 0.04780094077478296, 1.0845754551454632, -0.02335903762461697, 1.5278257314115253, 0.9902498376345181, -0.6194738701172651, -0.21595985704775997, -0.15661033077767947, 0.321517464061171, 1.367338649054599, 0.10629570342202052, 1.5214180820635552, 0.5133306308229246, -1.2099614681472564, -0.6140491135768454, 0.739172328123665, -0.13725935886904878, -0.7259578544172459, 1.263346428031892, -0.5525442457459965, -1.27158204987116, -0.7719483709675647, -0.3380222885915632, -0.5714926164452874, 0.0868453151147914, 0.4072015312468832, 0.8681046590573707, 0.609803652149957, -0.7297073375146437, -0.6922434572331928, -1.1507449855748437, 0.1378589958830458, -0.3852012019786363, 0.11252485862195093, 0.76287891262904, 0.01542412460602495, 1.3704526349010826, -1.5281370716333882, -0.4323491798912681, 0.7646459048390752, -1.1572288711051768, -0.22552629183646783, 1.1962793273823797, -0.6094527030486557, -0.5905569174282138, 0.9030620286277969, -0.24882872849308313, 1.2178188054060242, 1.1739977481072574, 0.2311225352183458, 0.74165200671213, 0.12369306309813208, 0.34763626924948066, 0.6055560293549953, 2.8725863859411223, 0.27727019128953656, 1.0175448613133522, -1.083957710686919, -0.848106112663438, 0.6076875591567827, -1.3539627961512037, 1.4650608226217041, 0.9101854127181286, -0.2042459976791748, 0.48630180859702765, -0.885563177243198, -0.06689786610858858, 1.9056577553882024, -0.8462080904765251, -0.053476801251498486, -0.7753067488080191, -0.7227229499966829, 0.47714174695673883, 0.2289138095997857, 0.6879031738164367, 0.9799441236578342, 0.3644148597901479, 1.5923654638283677, -0.16521084635820873, -0.06964384890832705, 2.366950282385053, 0.19774188212803073, 1.1857077050919032, 3.279132589276683, -0.12172936714158698, 1.0206899121542012, 0.9684293746810979, -0.5158111835242439, 0.09801103058335428, 1.1019938029206133, 1.0137503658890799, 0.9982308615438699, 0.5996451603808777, 0.9120799343146407, 0.3171434437639436, 1.0726596730711424, -0.03387826096480104, -0.579794940641075, 1.1603323437733304, 0.7875383177999316, -1.4335359767389564, 0.2271354987383613, 0.8115005068559444, 0.6146530058780687, 0.9338488233599131, 0.8797627190184688, 0.0498290495904042, 0.3879308208678346, -0.9834344843476465, -1.1421814970294184, 0.23891293294658322, 0.05507359211649296, 1.4779609029573897, 0.644648882558355, -1.238903866032522, -0.8622867278121454, 0.15623594827141363, -0.5499635540564113, 1.3315227801406058, 2.013949541836643, -1.0725494503494384, 0.7212995579842454, 1.0228514594770513, 0.21957155266179193, 1.1723941388888557, -0.1280501778769806, 1.458014817993962, 0.2448739620690026, -1.378863039957622, 1.0553407962200423, 0.8508463141075682, -0.5619369242209589, 0.9618377332515841, 0.8659913547288618, -0.7273850513878612, 1.7163581845989417, -0.7574870044044251, -0.3734580028175287, 0.01948620693605986, -0.29104390343775033, 1.526881572914977, 0.7693566362047852, -0.16610441555837746, -0.8644690159613108, -0.8644343539021945, -0.9780558951566443, -0.6048549328314039, 0.8015678315894067, -0.08123161192776604, -0.1572338383634972, -0.7861957604403115, -1.974924696874727, 0.021466294284188676, 0.5586122232255657, 0.12545672602118363, 0.4254826758122824, -0.19248033888879243, -0.6131659084759408, 0.2642572008230252, 0.6565090148506834, 1.2830136069516653, 2.175312053438423, 0.20294152528775306, -0.3750274628315343, 0.7934767915042068, -0.003963405177051432, -1.0160453898285795, 1.523778559062263, -0.5381439157832708, -0.5011124435373571, 2.0806255311808535, -0.18363521155671464, -0.34031132540577186, -0.015771507735448886, -0.36106238766493076, 0.20575164484656847, 0.8754605633412141, 1.3558472235085914, 0.9510744461475147, 1.4289301727685537, 1.6923143861107446, 0.013989394608884882, 1.4539845110181093, 2.4111776026518354, -1.319741019099393, 1.2268910139000275, 0.9098117277027925, 0.19464055818972736, 0.3522714991746294, 1.3508549819121096, 0.354061070081575, 0.8367414294169715, 0.8063146048047168, 0.7862615298057503, 1.820892553924078, 0.18178385610191963, 0.2111809559490699, -0.7454722696072166, -2.0869832702248514, 0.3283150682657958, 0.5756665485939217, -1.4562237041665678, 0.40897464308184317, -0.7195659489427693, -1.987828172510557, -1.5503720511485146, -0.9555684735576659, -0.06037202805237177, 1.7315476188008043, -0.29875470877267507, -0.7747631234954232, 0.31236284044216595, -0.6939103530199318, 0.533800658614222, 1.288313502439353, 0.7229336807246287, -0.8487687852065435, -1.4255387982494296, -1.7993766676016771, -0.32482030295815656, -0.9265078828295156, -0.28696559559615514, 1.4702921636516657, -1.3115532082840993, -0.9718158755260835, -2.2238113459462396, -1.017591768942865, 0.8637421223841112, 1.2176420336962352, 0.7867659652037572, 0.16626272876378123, 1.0742641511863156, -0.7277817642693057, -0.35859514172612234, 1.2578517065058128, 0.5687481086383055, 1.0807788758775587, 3.4019547872488203, 2.021534957876733, 0.4690720385165694, 0.48098558114259177, -1.0000058678662336, -0.0593409019603901, -0.2616306135094743, -0.30957040920195095, 0.9411347574808296, -0.3114455055112506, 0.5597128711295585, 0.3471429652912137, -1.1552278306266162, -0.44040649385136965, -0.9541503268225924, -1.0429511364248194, -0.4118643509769497, -0.6860100276125803, 0.3707337740956045, 0.8962987835404883, 0.016911356665158195, -0.613879241296868, -0.416430511303016, -1.2853684193396004, 0.11187856082529363, 0.16081637282158182, 0.8449740888986351, 1.1663336358038965, 0.045465718365993946, -1.3035055178715182, -0.3033893862287016, 0.18675406369588116, -0.6826029785684272, 0.5798044284587272, -0.31430220951902843, -0.1418226961260096, 0.42123682895287917, -0.7587023912138637, -0.7652571017648191, 0.11004359861631083, 0.07902353129608317, -1.1981113030023127, 1.923055466597875, 1.7538129529998598, 0.08855248735186531, 0.8727956441356586, 0.00036955920690044664, -0.4307220478565981, 0.6854765729694743, 0.9538174055315309, 0.7440151930626273, 0.5479953811052429, -1.0842786588786733, -1.520998654589959, -0.3307170677961923, -0.9847796378732551, 0.8593955803129476, 1.9559241754837842, -0.8129405760898589, -0.9823394873909903, -0.6098368514930287, -1.1910407495947137, 0.6960251323549065, 0.6009983437394718, 0.7659575230014909, -0.7198600187128633, -0.5668238237358052, 0.19430565243217235, -1.3075802691943388, -0.5452957104611842, -0.26299558975130155, -0.5741269106387452, 1.4506843317646314, 0.7445804022105892, 0.4977984362253868, 1.2764528850080734, -0.025962058194233417, -0.6617093619406217, -1.4536786042379426, 0.5520595679739155, 2.140694738147101, 0.09905296028217919, -0.37741447055460664, 0.6304705882029709, -1.390527354113447, -3.654591728371163, 0.13371623627523296, 0.7450736524197342, -0.6488766445118901, -0.18044497160518427, 0.09178546351629371, -0.4961642825917315, -1.1251196823752285, -1.1062827012526943, 0.42156564787747136, -0.6406250546463332, 0.6224857935418803, 2.101442399786695, -0.8849932554386127, -0.13090605899689065, -0.41398541974524194, -1.5894908377786627, -1.1605407047467264, 0.09399854282049314, 0.9066731684921476, -1.2271128067386146, 0.10188208844721902, -1.185845315607031, -3.012642596779243, 0.3673855822921449, -0.029140446789096608, 0.008443136342537905, 1.9547950545331543, 1.3414036469634518, -0.1344377019724935, 0.6852701414202361, 0.09451537213323394, 0.8892245005377257, 1.8657716715372163, 1.1213848706988983, 0.7262392034226526, 0.8713938025037367, 0.044443512667849086, 0.4244924542494206, 0.5348987093990824, 0.27663787686359925, 1.1668695515742091, 1.3239642359222346, -0.33864637677165116, -0.33037870661118474, -1.2527432882572447, -2.459972500596228, 0.8959091858641564, 0.5838933529079577, 0.3804738512215079, -0.6542755484871305, -0.23595882909952245, -1.9790610549481165, -1.6761843456200953, -0.1065747202803988, -0.8269903532509598, 1.506270184727185, 1.81163006276026, 1.0162351578483035, 0.021692101679802733, -0.25874489939309114, 1.2567667393767485, 0.18807077071461853, 0.9565201961797293, 0.6235936934315095, 1.3205460387374055, -0.03447579116970828, -0.9849085530245149, -0.3525099357800653, -0.5230391699648224, -0.12116249914199326, 0.9477424706156979, 0.5426240577907981, -1.0269381925375332, 0.4196515821876161, -1.3706316780462873, -0.06293024652780976, 0.14026602589682047, -0.931074825111924, 0.7040304103774185, 1.1544674128747536, -0.9982219078059935, -0.21917694203324656, 1.740048982507644, 0.6517859386412357, -0.5820159734689048, 0.8992683500793036, 0.31306430722509887, 0.0037476502137172296, 1.4037862240266554, -0.1916399680651662, -2.542509781265394, 0.6729196342902852, -1.5580265229224213, -1.2874414907573533, 1.002709707804743, -1.3367687111433857, -1.091711203681256, 0.2773792552857807, -2.423418546068491, -0.9824387553622412, -0.6767037828302814, -0.462676823485132, -0.9068773022921707, -1.2286247661752805, -1.2780280542853975, -1.9047763604741366, -1.3101439752359043, -0.056851591990907016, -1.7436612614418352, -1.375536836103815, -0.07700357367232058, -2.310693251175362, -0.8882816080899146, -0.38918443934986663, -0.0854315828161042, 0.7571775175810174, 1.7217470231439114, 0.26339467135865186, 0.08400082290349217, 1.1489841489952175, 0.511520831316537, -0.2305413466501985, 1.42618429109856, 0.5505013233540934, -1.165049260221926, 0.6727615263560244, 0.49251654981223414, 1.0316170274087284, 0.810452391239453, -0.018565174613040858, 2.1772916293029376, -1.0068254046024576, -0.9711696016078576, 1.7201373804837436, -0.7306748382351906, 1.4040563212967085, -0.34878390257448577, -0.9922868730974722, 0.3863957406910914, -1.7967591321234737, -0.5544056296041169, 1.058390247972659]

# create a bunch adaptive filters
#filter=pra.adaptive.RLS(length, lmbd=1.0, delta=2.0)
filter=pra.adaptive.NLMS(length, mu=0.5)
#filter=pra.adaptive.BlockLMS(length, mu=1.0 / 15.0 / 2.0, L=8, nlms=True)
#filter=pra.adaptive.BlockRLS(length, lmbd=1, delta=2.0, L=8)
error=np.zeros(n_samples)
start_time = time.time()
for i in range(n_samples):
    filter.update(x[i], d[i])
    error[i] = np.linalg.norm(filter.w - w)
    
""" for i in range(n_samples):
    if i % 16 == 0:
        print(error[i])  """
print(error[-1])
print(filter.w)
print(time.time() - start_time)
""" plt.plot(w)
for algo in adfilt.values():
    plt.plot(algo["filter"].w)
plt.title("Original and reconstructed filters")
plt.legend(["groundtruth"] + list(adfilt))

plt.figure()
for algo in adfilt.values():
    plt.semilogy(algo["error"])
plt.legend(adfilt)
plt.title("Convergence to unknown filter")
plt.show() """
